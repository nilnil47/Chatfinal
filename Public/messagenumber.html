<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
      integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="css/style.css" />
    <title>Negotiation number</title>
  </head>
  <body >
    <div  style="display: flex;  ">
      
    </div>
    <div class="join-container">
      <header class="join-header">
        <h1 ><i><img src="https://scontent.ftlv5-1.fna.fbcdn.net/v/t1.6435-9/155379338_3912200072134580_7295162422057122146_n.jpg?_nc_cat=102&_nc_map=test-rt&ccb=1-3&_nc_sid=730e14&_nc_ohc=ci1YXJ2WmCgAX-JmapW&_nc_ht=scontent.ftlv5-1.fna&oh=ced579c41d07ceec0110cb82840997b3&oe=60C2DE73" 
        width="80" height="90" alt="webmaster logo" /></i>Negotiation's messages number</h1>
      </header>


          
  
         <h1 id="data1"  style="background-color: rgb(255, 255, 255); color: #000;">


      <script>
   
        const yourUrl = "http://localhost:3000/api/query3";
        
        fetch(yourUrl)
          .then(res=>res.json())
          .then((res) => {
            var strHtml = "";
            strHtml += /*html*/`
              
       

            <table id="data" border="6" style="margin-left:auto; font-size:15px; margin-right:auto;">
            <tr>

              <th>Negotiation Id</th>
               <th>Title</th>
               <th>Messages Number</th>
     
  
            </tr>
              
           
      
              `;
            
            var myarray = res;      
            myarray.forEach((obj) => {
            let { negoid, title,Num } = obj;
            strHtml += /*html*/`
              
<tr>
              <td>${negoid} </td>           
              <td>${title}</td>
              <td>${Num}</td>
 



            </tr>

        
             
      
              `;
            });
          

            //console.log(strHtml);
            strHtml += /*html*/`
            <CENTER><button onclick="exportTableToExcel('data')">Export Table Data To Excel File</button>        
                `;

            document.getElementById("data1").innerHTML = strHtml;
            
          });
 

          function approvenMed(name){
          const yourUrl = 'http://localhost:3000/api/approvenMed'
          const object = {
            username:name
          }
          console.log(object.username);


       
          var xhr = new XMLHttpRequest();
          xhr.open("POST", yourUrl, true);
          xhr.setRequestHeader('Content-Type', 'application/json');
          xhr.send(JSON.stringify(object));
      
          
        } 

        function exportTableToExcel(tableID, filename = ''){
    var downloadLink;
    var dataType = 'application/vnd.ms-excel';
    var tableSelect = document.getElementById(tableID);
    var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
    
    // Specify file name
    filename = filename?filename+'.xls':'excel_data.xls';
    
    // Create download link element
    downloadLink = document.createElement("a");
    
    document.body.appendChild(downloadLink);
    
    if(navigator.msSaveOrOpenBlob){
        var blob = new Blob(['\ufeff', tableHTML], {
            type: dataType
        });
        navigator.msSaveOrOpenBlob( blob, filename);
    }else{
        // Create a link to the file
        downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
    
        // Setting the file name
        downloadLink.download = filename;
        
        //triggering the function
        downloadLink.click();
    }
}
//link help me: https://www.codexworld.com/export-html-table-data-to-excel-using-javascript/
        </script>





          </a>
        </div>
      </main>
    </div>
  </div>
  </body>
</html>
