<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
      integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="css/style.css" />
    <title>User negotiations</title>
  </head>
  <body >
    <div  style="display: flex;  ">
      
    </div>
    <div class="join-container">
      <header class="join-header">
        <h1 ><i><img src="https://scontent.ftlv5-1.fna.fbcdn.net/v/t1.6435-9/155379338_3912200072134580_7295162422057122146_n.jpg?_nc_cat=102&_nc_map=test-rt&ccb=1-3&_nc_sid=730e14&_nc_ohc=ci1YXJ2WmCgAX-JmapW&_nc_ht=scontent.ftlv5-1.fna&oh=ced579c41d07ceec0110cb82840997b3&oe=60C2DE73" 
        width="80" height="90" alt="webmaster logo" /></i>User's negotiations</h1>
      </header>


          
  
         <h1 id="data1"  style="background-color: rgb(255, 255, 255); color: #000;">


      <script>
   
        const yourUrl = "/api/query2";
        
        fetch(yourUrl)
          .then(res=>res.json())
          .then((res) => {
            var strHtml = "";
            strHtml += /*html*/`
              
       

            <table id="data" border="6" style="margin-left:auto; font-size:15px; margin-right:auto;">
            <tr>
              <th>User Code</th>
               <th>First Name</th>
               <th>Last Name</th>
               <th>User Type</th>
               <th>Number of negotiation</th>
 

  
            </tr>
              
           
      
              `;
            
            var myarray = res;  
                
            myarray.forEach((obj) => {
            let { userCode, firstName,lastName, userType, Num } = obj;
            var name=obj.username;
            strHtml += /*html*/`
              
<tr>
              <td>${userCode} </td>           
              <td>${firstName}</td>
              <td>${lastName}</td>
              <td>${userType}</td>

              <td> ${Num}</td>
         

            </tr>

        
             
      
              `;
            });
          

            //console.log(strHtml);
            strHtml += /*html*/`
            <CENTER><button onclick="exportTableToExcel('data')">Export Table Data To Excel File</button>        
                `;

            document.getElementById("data1").innerHTML = strHtml;
            
          });
 


        function exportTableToExcel(tableID, filename = ''){
    var downloadLink;
    var dataType = 'application/vnd.ms-excel';
    var tableSelect = document.getElementById(tableID);
    var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
    
    // Specify file name
    filename = filename?filename+'.xls':'excel_data.xls';
    
    // Create download link element
    downloadLink = document.createElement("a");
    
    document.body.appendChild(downloadLink);
    
    if(navigator.msSaveOrOpenBlob){
        var blob = new Blob(['\ufeff', tableHTML], {
            type: dataType
        });
        navigator.msSaveOrOpenBlob( blob, filename);
    }else{
        // Create a link to the file
        downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
    
        // Setting the file name
        downloadLink.download = filename;
        
        //triggering the function
        downloadLink.click();
    }
}
//link help me: https://www.codexworld.com/export-html-table-data-to-excel-using-javascript/
        </script>





          </a>
        </div>
      </main>
    </div>
  </div>
  </body>
  <center> <a href="index.html">
    <button>Logout</button></a></center>
</html>
